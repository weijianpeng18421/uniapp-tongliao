/*
 
jSignature v2 "2012-12-17T07:23" "commit ID 0fe620bb3d7a930795f2b2e7a2f25bd861311718"
Copyright (c) 2012 Willow Systems Corp http://willow-systems.com
Copyright (c) 2010 Brinley Ang http://www.unbolt.net
MIT License <http://www.opensource.org/licenses/mit-license.php> 


Simplify.js BSD 
(c) 2012, Vladimir Agafonkin
mourner.github.com/simplify-js


base64 encoder
MIT, GPL
http://phpjs.org/functions/base64_encode
+   original by: Tyler Akins (http://rumkin.com)
+   improved by: Bayron Guevara
+   improved by: Thunder.m
+   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+   bugfixed by: Pellentesque Malesuada
+   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+   improved by: Rafal Kukawski (http://kukawski.pl)


jSignature v2 jSignature's Undo Button and undo functionality plugin


jSignature v2 jSignature's custom "base30" format export and import plugins.


jSignature v2 SVG export plugin.

*/
(function(){function r(b){var l,t=b.css("color"),g;b=b[0];for(var c=!1;b&&!g&&!c;){try{l=$(b).css("background-color")}catch(d){l="transparent"}"transparent"!==l&&"rgba(0, 0, 0, 0)"!==l&&(g=l);c=b.body;b=b.parentNode}b=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/;var c=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/,a;l=void 0;(l=t.match(b))?a={r:parseInt(l[1],10),g:parseInt(l[2],10),b:parseInt(l[3],10)}:(l=t.match(c))&&(a={r:parseInt(l[1],16),g:parseInt(l[2],16),b:parseInt(l[3],16)});var f;
g?(l=void 0,(l=g.match(b))?f={r:parseInt(l[1],10),g:parseInt(l[2],10),b:parseInt(l[3],10)}:(l=g.match(c))&&(f={r:parseInt(l[1],16),g:parseInt(l[2],16),b:parseInt(l[3],16)})):f=a?127<Math.max.apply(null,[a.r,a.g,a.b])?{r:0,g:0,b:0}:{r:255,g:255,b:255}:{r:255,g:255,b:255};l=function(b){return"rgb("+[b.r,b.g,b.b].join(", ")+")"};a&&f?(b=Math.max.apply(null,[a.r,a.g,a.b]),a=Math.max.apply(null,[f.r,f.g,f.b]),a=Math.round(a+-0.75*(a-b)),a={r:a,g:a,b:a}):a?(a=Math.max.apply(null,[a.r,a.g,a.b]),b=1,127<
a&&(b=-1),a=Math.round(a+96*b),a={r:a,g:a,b:a}):a={r:191,g:191,b:191};return{color:t,"background-color":f?l(f):g,"decor-color":l(a)}}function n(b,l){this.x=b;this.y=l;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var t=function(b){return Math.round(b/Math.abs(b))};this.resizeTo=function(b){if(0===this.x&&0===this.y)this._length=
0;else if(0===this.x)this._length=b,this.y=b*t(this.y);else if(0===this.y)this._length=b,this.x=b*t(this.x);else{var l=Math.abs(this.y/this.x),a=Math.sqrt(Math.pow(b,2)/(1+Math.pow(l,2))),l=l*a;this._length=b;this.x=a*t(this.x);this.y=l*t(this.y)}return this};this.angleTo=function(b){var l=this.getLength()*b.getLength();return 0===l?0:Math.acos(Math.min(Math.max((this.x*b.x+this.y*b.y)/l,-1),1))/Math.PI}}function m(b,l){this.x=b;this.y=l;this.getVectorToCoordinates=function(b,l){return new n(b-this.x,
l-this.y)};this.getVectorFromCoordinates=function(b,l){return this.getVectorToCoordinates(b,l).reverse()};this.getVectorToPoint=function(b){return new n(b.x-this.x,b.y-this.y)};this.getVectorFromPoint=function(b){return this.getVectorToPoint(b).reverse()}}function u(b,l,a,g,c){this.data=b;this.context=l;if(b.length)for(var d=b.length,f,j,k=0;k<d;k++){f=b[k];j=f.x.length;a.call(l,f);for(var e=1;e<j;e++)g.call(l,f,e);c.call(l,f)}this.changed=function(){};this.startStrokeFn=a;this.addToStrokeFn=g;this.endStrokeFn=
c;this.inStroke=!1;this._stroke=this._lastPoint=null;this.startStroke=function(b){if(b&&"number"==typeof b.x&&"number"==typeof b.y){this._stroke={x:[b.x],y:[b.y]};this.data.push(this._stroke);this._lastPoint=b;this.inStroke=!0;var l=this._stroke,a=this.startStrokeFn,g=this.context;setTimeout(function(){a.call(g,l)},3);return b}return null};this.addToStroke=function(b){if(this.inStroke&&"number"===typeof b.x&&"number"===typeof b.y&&4<Math.abs(b.x-this._lastPoint.x)+Math.abs(b.y-this._lastPoint.y)){var l=
this._stroke.x.length;this._stroke.x.push(b.x);this._stroke.y.push(b.y);this._lastPoint=b;var a=this._stroke,g=this.addToStrokeFn,t=this.context;setTimeout(function(){g.call(t,a,l)},3);return b}return null};this.endStroke=function(){var b=this.inStroke;this.inStroke=!1;this._lastPoint=null;if(b){var l=this._stroke,a=this.endStrokeFn,g=this.context,t=this.changed;setTimeout(function(){a.call(g,l);t.call(g)},3);return!0}return null}}function s(b,l,a){var g=this.$parent=$(b);b=this.eventTokens={};this.events=
new w(this);var c=$.fn[e]("globalEvents"),d={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10,showUndoButton:!1,readOnly:!1,data:[]};$.extend(d,r(g));l&&$.extend(d,l);this.settings=d;for(var f in a)a.hasOwnProperty(f)&&a[f].call(this,f);this.events.publish(e+".initializing");this.$controlbarUpper=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1em !important;margin-bottom:1em !important;"></div>').appendTo(g);
this.isCanvasEmulator=!1;a=this.canvas=this.initializeCanvas(d);l=$(a);this.$controlbarLower=$('<div style="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1.5em !important;margin-bottom:1.5em !important;"></div>').appendTo(g);this.canvasContext=a.getContext("2d");l.data(e+".this",this);g=(g=d.lineWidth)?g:Math.max(Math.round(a.width/400),2);d.lineWidth=g;this.lineCurveThreshold=3*d.lineWidth;d.cssclass&&""!=$.trim(d.cssclass)&&l.addClass(d.cssclass);
this.fatFingerCompensation=0;var g=function(b){var l,a,g=function(g){g=g.changedTouches&&0<g.changedTouches.length?g.changedTouches[0]:g;return new m(Math.round(g.pageX+l),Math.round(g.pageY+a)+b.fatFingerCompensation)},d=new z(750,function(){b.dataEngine.endStroke()});this.drawEndHandler=function(l){if(!b.settings.readOnly){try{l.preventDefault()}catch(a){}d.clear();b.dataEngine.endStroke()}};this.drawStartHandler=function(c){if(!b.settings.readOnly){c.preventDefault();var t=$(b.canvas).offset();
l=-1*t.left;a=-1*t.top;b.dataEngine.startStroke(g(c));d.kick()}};this.drawMoveHandler=function(l){b.settings.readOnly||(l.preventDefault(),b.dataEngine.inStroke&&(b.dataEngine.addToStroke(g(l)),d.kick()))};return this}.call({},this),j=g.drawEndHandler,k=g.drawStartHandler,p=g.drawMoveHandler,h=this.canvas;l=$(h);this.isCanvasEmulator?(l.bind("mousemove."+e,p),l.bind("mouseup."+e,j),l.bind("mousedown."+e,k)):(h.ontouchstart=function(b){h.onmousedown=void 0;h.onmouseup=void 0;h.onmousemove=void 0;this.fatFingerCompensation=
d.minFatFingerCompensation&&-3*d.lineWidth>d.minFatFingerCompensation?-3*d.lineWidth:d.minFatFingerCompensation;k(b);h.ontouchend=j;h.ontouchstart=k;h.ontouchmove=p},h.onmousedown=function(b){h.ontouchstart=void 0;h.ontouchend=void 0;h.ontouchmove=void 0;k(b);h.onmousedown=k;h.onmouseup=j;h.onmousemove=p});b[e+".windowmouseup"]=c.subscribe(e+".windowmouseup",g.drawEndHandler);this.events.publish(e+".attachingEventHandlers");var q=this;b=d.width.toString(10);var x=e;if("ratio"===b||"%"===b.split("")[b.length-
1])this.eventTokens[x+".parentresized"]=c.subscribe(x+".parentresized",function(b,l,a){return function(){var g=l.width();if(g!==a){for(var d in b)b.hasOwnProperty(d)&&(c.unsubscribe(b[d]),delete b[d]);var t=q.settings;q.$parent.children().remove();for(d in q)q.hasOwnProperty(d)&&delete q[d];d=t.data;var g=1*g/a,f=[],j,k,e,h,m,p;k=0;for(e=d.length;k<e;k++){p=d[k];j={x:[],y:[]};h=0;for(m=p.x.length;h<m;h++)j.x.push(p.x[h]*g),j.y.push(p.y[h]*g);f.push(j)}t.data=f;l[x](t)}}}(this.eventTokens,this.$parent,
this.$parent.width(),1*this.canvas.width/this.canvas.height));this.resetCanvas(d.data);this.events.publish(e+".initialized");return this}var e="jSignature",z=function(b,l){var a;this.kick=function(){clearTimeout(a);a=setTimeout(l,b)};this.clear=function(){clearTimeout(a)};return this},w=function(b){this.topics={};this.context=b?b:this;this.publish=function(b,a,g,d){if(this.topics[b]){var c=this.topics[b],f=Array.prototype.slice.call(arguments,1),j=[],k,e,h,p;e=0;for(h=c.length;e<h;e++)p=c[e],k=p[0],
p[1]&&(p[0]=function(){},j.push(e)),k.apply(this.context,f);e=0;for(h=j.length;e<h;e++)c.splice(j[e],1)}};this.subscribe=function(b,a,g){this.topics[b]?this.topics[b].push([a,g]):this.topics[b]=[[a,g]];return{topic:b,callback:a}};this.unsubscribe=function(b){if(this.topics[b.topic])for(var a=this.topics[b.topic],g=0,d=a.length;g<d;g++)a[g][0]===b.callback&&a.splice(g,1)}},A=function(b){var a=this.canvasContext,d=b.x[0];b=b.y[0];var g=this.settings.lineWidth,c=a.fillStyle;a.fillStyle=a.strokeStyle;
a.fillRect(d+g/-2,b+g/-2,g,g);a.fillStyle=c},v=function(b,a){var d=new m(b.x[a-1],b.y[a-1]),g=new m(b.x[a],b.y[a]),c=d.getVectorToPoint(g);if(1<a){var f=new m(b.x[a-2],b.y[a-2]),j=f.getVectorToPoint(d),k;if(j.getLength()>this.lineCurveThreshold){k=2<a?(new m(b.x[a-3],b.y[a-3])).getVectorToPoint(f):new n(0,0);var e=0.35*j.getLength(),h=j.angleTo(k.reverse()),p=c.angleTo(j.reverse());k=(new n(k.x+j.x,k.y+j.y)).resizeTo(Math.max(0.05,h)*e);var q=(new n(j.x+c.x,j.y+c.y)).reverse().resizeTo(Math.max(0.05,
p)*e),j=this.canvasContext,e=f.x,p=f.y,h=d.x,x=d.y,B=f.x+k.x,f=f.y+k.y;k=d.x+q.x;q=d.y+q.y;j.beginPath();j.moveTo(e,p);j.bezierCurveTo(B,f,k,q,h,x);j.stroke()}}c.getLength()<=this.lineCurveThreshold&&(c=this.canvasContext,f=d.x,d=d.y,k=g.x,g=g.y,c.beginPath(),c.moveTo(f,d),c.lineTo(k,g),c.stroke())},y=function(b){var a=b.x.length-1;if(0<a){var d=new m(b.x[a],b.y[a]),g=new m(b.x[a-1],b.y[a-1]),c=g.getVectorToPoint(d);if(c.getLength()>this.lineCurveThreshold){if(1<a){b=(new m(b.x[a-2],b.y[a-2])).getVectorToPoint(g);
var f=(new n(b.x+c.x,b.y+c.y)).resizeTo(c.getLength()/2),c=this.canvasContext;b=g.x;var a=g.y,j=d.x,k=d.y,e=g.x+f.x,g=g.y+f.y,f=d.x,d=d.y;c.beginPath();c.moveTo(b,a);c.bezierCurveTo(e,g,f,d,j,k)}else c=this.canvasContext,b=g.x,g=g.y,a=d.x,d=d.y,c.beginPath(),c.moveTo(b,g),c.lineTo(a,d);c.stroke()}}};s.prototype.resetCanvas=function(b){var a=this.canvas,d=this.settings,c=this.canvasContext,f=this.isCanvasEmulator,j=a.width,k=a.height;c.clearRect(0,0,j+30,k+30);c.shadowColor=c.fillStyle=d["background-color"];
f&&c.fillRect(0,0,j+30,k+30);c.lineWidth=Math.ceil(parseInt(d.lineWidth,10));c.lineCap=c.lineJoin="round";c.strokeStyle=d["decor-color"];c.shadowOffsetX=0;c.shadowOffsetY=0;var h=Math.round(k/5),p=1.5*h,m=k-h,j=j-1.5*h,k=k-h;c.beginPath();c.moveTo(p,m);c.lineTo(j,k);c.stroke();c.strokeStyle=d.color;f||(c.shadowColor=c.strokeStyle,c.shadowOffsetX=0.5*c.lineWidth,c.shadowOffsetY=-0.6*c.lineWidth,c.shadowBlur=0);b||(b=[]);c=this.dataEngine=new u(b,this,A,v,y);d.data=b;$(a).data(e+".data",b).data(e+".settings",
d);var q=this.$parent,x=this.events,B=e;c.changed=function(){x.publish(B+".change");q.trigger("change")};c.changed();return!0};s.prototype.initializeCanvas=function(b){var a=document.createElement("canvas"),c=$(a);b.width===b.height&&"ratio"===b.height&&(b.width="100%");c.css("margin",0).css("padding",0).css("border","none").css("height","ratio"===b.height||!b.height?1:b.height.toString(10)).css("width","ratio"===b.width||!b.width?1:b.width.toString(10));c.appendTo(this.$parent);"ratio"===b.height?
c.css("height",Math.round(c.width()/b.sizeRatio)):"ratio"===b.width&&c.css("width",Math.round(c.height()*b.sizeRatio));c.addClass(e);a.width=c.width();a.height=c.height();b=a;if(b.getContext)b=!1;else{var c=b.ownerDocument.parentWindow,d=c.FlashCanvas?b.ownerDocument.parentWindow.FlashCanvas:"undefined"===typeof FlashCanvas?void 0:FlashCanvas;if(d){b=d.initElement(b);d=1;c&&(c.screen&&c.screen.deviceXDPI&&c.screen.logicalXDPI)&&(d=1*c.screen.deviceXDPI/c.screen.logicalXDPI);if(1!==d)try{$(b).children("object").get(0).resize(Math.ceil(b.width*
d),Math.ceil(b.height*d)),b.getContext("2d").scale(d,d)}catch(f){}b=!0}else throw Error("Canvas element does not support 2d context. jSignature cannot proceed.");}this.isCanvasEmulator=b;a.onselectstart=function(b){b&&b.preventDefault&&b.preventDefault();b&&b.stopPropagation&&b.stopPropagation();return!1};return a};var p=window,h=function(b,a){var c=new Image,d=this;c.onload=function(){d.getContext("2d").drawImage(c,0,0,c.width<d.width?c.width:d.width,c.height<d.height?c.height:d.height)};c.src="data:"+
a+","+b},a=function(b){this.find("canvas."+e).add(this.filter("canvas."+e)).data(e+".this").resetCanvas(b);return this},f=function(b,a){if(void 0===a&&("string"===typeof b&&"data:"===b.substr(0,5))&&(a=b.slice(5).split(",")[0],b=b.slice(6+a.length),a===b))return;var c=this.find("canvas."+e).add(this.filter("canvas."+e));if(q.hasOwnProperty(a))0!==c.length&&q[a].call(c[0],b,a,function(b){return function(){return b.resetCanvas.apply(b,arguments)}}(c.data(e+".this")));else throw Error(e+" is unable to find import plugin with for format '"+
String(a)+"'");return this},d=new w,c=e,j,k=function(){d.publish(c+".parentresized")};$(p).bind("resize."+c,function(){j&&clearTimeout(j);j=setTimeout(k,500)}).bind("mouseup."+c,function(){d.publish(c+".windowmouseup")});var x={},B={"default":function(){return this.toDataURL()},"native":function(b){return b},image:function(){var b=this.toDataURL();if("string"===typeof b&&4<b.length&&"data:"===b.slice(0,5)&&-1!==b.indexOf(",")){var a=b.indexOf(",");return[b.slice(5,a),b.substr(a+1)]}return[]}},q={"native":function(b,
a,c){c(b)},image:h,"image/png;base64":h,"image/jpeg;base64":h,"image/jpg;base64":h},C={"export":B,"import":q,instance:x},D={init:function(b){return this.each(function(){var a,c=!1;for(a=this.parentNode;a&&!c;)c=a.body,a=a.parentNode;!c||new s(this,b,x)})},getSettings:function(){return this.find("canvas."+e).add(this.filter("canvas."+e)).data(e+".this").settings},clear:a,reset:a,addPlugin:function(b,a,c){C.hasOwnProperty(b)&&(C[b][a]=c);return this},listPlugins:function(b){var a=[];if(C.hasOwnProperty(b)){b=
C[b];for(var c in b)b.hasOwnProperty(c)&&a.push(c)}return a},getData:function(b){var a=this.find("canvas."+e).add(this.filter("canvas."+e));void 0===b&&(b="default");if(0!==a.length&&B.hasOwnProperty(b))return B[b].call(a.get(0),a.data(e+".data"))},importData:f,setData:f,globalEvents:function(){return d},disable:function(){this.find("input").attr("disabled",1);this.find("canvas."+e).addClass("disabled").data(e+".this").settings.readOnly=!0},enable:function(){this.find("input").removeAttr("disabled");
this.find("canvas."+e).removeClass("disabled").data(e+".this").settings.readOnly=!1},events:function(){return this.find("canvas."+e).add(this.filter("canvas."+e)).data(e+".this").events}};$.fn[e]=function(b){if(!b||"object"===typeof b)return D.init.apply(this,arguments);if("string"===typeof b&&D[b])return D[b].apply(this,Array.prototype.slice.call(arguments,1));$.error("Method "+String(b)+" does not exist on jQuery."+e)}})();
(function(){$.fn.jSignature("addPlugin","instance","UndoButton",function(r){this.events.subscribe("jSignature.attachingEventHandlers",function(){if(this.settings[r]){var n=this.settings[r];"function"!==typeof n&&(n=function(){var e=$('<input type="button" value="Undo last stroke" style="position:absolute;display:none;margin:0 !important;top:auto" />').appendTo(this.$controlbarLower),m=e.width();e.css("left",Math.round((this.canvas.width-m)/2));m!==e.width()&&e.width(m);return e});var m=n.call(this),
u=this;u.events.subscribe("jSignature.change",function(){u.dataEngine.data.length?m.show():m.hide()});var s=this,e=(this.events.topics.hasOwnProperty("jSignature.undo")?r:"jSignature")+".undo";m.bind("click",function(){s.events.publish(e)});s.events.subscribe(e,function(){var e=s.dataEngine.data;e.length&&(e.pop(),s.resetCanvas(e))})}})})})();
(function(){for(var r={},n={},m="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX".split(""),u=m.length/2,s=u-1;-1<s;s--)r[m[s]]=m[s+u],n[m[s+u]]=m[s];var e=function(e){e=e.split("");for(var h=e.length,a=1;a<h;a++)e[a]=r[e[a]];return e.join("")},z=function(m){for(var h=[],a=0,f=1,d=m.length,c,j,k=0;k<d;k++)c=Math.round(m[k]),j=c-a,a=c,0>j&&0<f?(f=-1,h.push("Z")):0<j&&0>f&&(f=1,h.push("Y")),c=Math.abs(j),c>=u?h.push(e(c.toString(u))):h.push(c.toString(u));return h.join("")},w=function(e){var h=
[];e=e.split("");for(var a=e.length,f,d=1,c=[],j=0,k=0;k<a;k++)f=e[k],f in r||"Z"===f||"Y"===f?(0!==c.length&&(c=parseInt(c.join(""),u)*d+j,h.push(c),j=c),"Z"===f?(d=-1,c=[]):"Y"===f?(d=1,c=[]):c=[f]):c.push(n[f]);h.push(parseInt(c.join(""),u)*d+j);return h},A=function(e){for(var h=[],a=e.length,f,d=0;d<a;d++)f=e[d],h.push(z(f.x)),h.push(z(f.y));return h.join("_")},v=function(e){var h=[];e=e.split("_");for(var a=e.length/2,f=0;f<a;f++)h.push({x:w(e[2*f]),y:w(e[2*f+1])});return h},m=function(e){return["image/jsignature;base30",
A(e)]},s=function(e,h,a){"string"===typeof e&&("image/jsignature;base30"===e.substring(0,23).toLowerCase()&&(e=e.substring(24)),a(v(e)))};if(null==this.jQuery)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");var y=this.jQuery.fn.jSignature;y("addPlugin","export","base30",m);y("addPlugin","export","image/jsignature;base30",m);y("addPlugin","import","base30",s);y("addPlugin","import","image/jsignature;base30",s);this.jSignatureDebug&&(this.jSignatureDebug.base30=
{remapTailChars:e,compressstrokeleg:z,uncompressstrokeleg:w,compressstrokes:A,uncompressstrokes:v,charmap:r})}).call("undefined"!==typeof window?window:this);
(function(){function r(a,f){this.x=a;this.y=f;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var d=function(a){return Math.round(a/Math.abs(a))};this.resizeTo=function(a){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=a,this.y=a*d(this.y);else if(0===this.y)this._length=a,this.x=a*d(this.x);else{var f=Math.abs(this.y/
this.x),e=Math.sqrt(Math.pow(a,2)/(1+Math.pow(f,2))),f=f*e;this._length=a;this.x=e*d(this.x);this.y=f*d(this.y)}return this};this.angleTo=function(a){var d=this.getLength()*a.getLength();return 0===d?0:Math.acos(Math.min(Math.max((this.x*a.x+this.y*a.y)/d,-1),1))/Math.PI}}function n(a,f){this.x=a;this.y=f;this.getVectorToCoordinates=function(a,c){return new r(a-this.x,c-this.y)};this.getVectorFromCoordinates=function(a,c){return this.getVectorToCoordinates(a,c).reverse()};this.getVectorToPoint=function(a){return new r(a.x-
this.x,a.y-this.y)};this.getVectorFromPoint=function(a){return this.getVectorToPoint(a).reverse()}}function m(a,f){var d=Math.pow(10,f);return Math.round(a*d)/d}function u(a,f,d){f+=1;var c=new n(a.x[f-1],a.y[f-1]),e=new n(a.x[f],a.y[f]),e=c.getVectorToPoint(e),k=new n(a.x[f-2],a.y[f-2]),c=k.getVectorToPoint(c);return c.getLength()>d?(d=2<f?(new n(a.x[f-3],a.y[f-3])).getVectorToPoint(k):new r(0,0),a=0.35*c.getLength(),k=c.angleTo(d.reverse()),f=e.angleTo(c.reverse()),d=(new r(d.x+c.x,d.y+c.y)).resizeTo(Math.max(0.05,
k)*a),e=(new r(c.x+e.x,c.y+e.y)).reverse().resizeTo(Math.max(0.05,f)*a),e=new r(c.x+e.x,c.y+e.y),["c",m(d.x,2),m(d.y,2),m(e.x,2),m(e.y,2),m(c.x,2),m(c.y,2)]):["l",m(c.x,2),m(c.y,2)]}function s(a,e){var d=a.x.length-1,c=new n(a.x[d],a.y[d]),j=new n(a.x[d-1],a.y[d-1]),c=j.getVectorToPoint(c);if(1<d&&c.getLength()>e){var d=(new n(a.x[d-2],a.y[d-2])).getVectorToPoint(j),j=c.angleTo(d.reverse()),k=0.35*c.getLength(),d=(new r(d.x+c.x,d.y+c.y)).resizeTo(Math.max(0.05,j)*k);return["c",m(d.x,2),m(d.y,2),m(c.x,
2),m(c.y,2),m(c.x,2),m(c.y,2)]}return["l",m(c.x,2),m(c.y,2)]}function e(a,e,d){e=["M",m(a.x[0]-e,2),m(a.y[0]-d,2)];d=1;for(var c=a.x.length-1;d<c;d++)e.push.apply(e,u(a,d,1));0<c?e.push.apply(e,s(a,d,1)):0===c&&e.push.apply(e,["l",1,1]);return e.join(" ")}function z(a){var f=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'],d,c=a.length,j,k=[],h=[],m=j=d=0,q=0,p=[];if(0!==c){for(d=0;d<c;d++){m=
a[d];q=[];j={x:[],y:[]};for(var n=void 0,b=void 0,n=0,b=m.x.length;n<b;n++)q.push({x:m.x[n],y:m.y[n]});q=simplify(q,0.7,!0);n=0;for(b=q.length;n<b;n++)j.x.push(q[n].x),j.y.push(q[n].y);p.push(j);k=k.concat(j.x);h=h.concat(j.y)}a=Math.min.apply(null,k)-1;c=Math.max.apply(null,k)+1;k=Math.min.apply(null,h)-1;h=Math.max.apply(null,h)+1;m=0>a?0:a;q=0>k?0:k;d=c-a;j=h-k}f.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+d.toString()+'" height="'+j.toString()+'">');d=0;for(c=p.length;d<
c;d++)j=p[d],f.push('<path fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="'+e(j,m,q)+'"/>');f.push("</svg>");return f.join("")}function w(a){return[p,z(a)]}function A(a){return[h,y(z(a))]}var v=window;"use strict";("undefined"!=typeof exports?exports:v).simplify=function(a,e,d){e=void 0!==e?e*e:1;if(!d){var c=a.length,j,k=a[0],h=[k];for(d=1;d<c;d++){j=a[d];var m=j.x-k.x,q=j.y-k.y;m*m+q*q>e&&(h.push(j),k=j)}a=(k!==j&&h.push(j),h)}j=a;d=j.length;var c=
new ("undefined"!=typeof Uint8Array?Uint8Array:Array)(d),k=0,h=d-1,n,p,b=[],l=[],t=[];for(c[k]=c[h]=1;h;){q=0;for(m=k+1;m<h;m++){n=j[m];var g=j[k],s=j[h],r=g.x,u=g.y,g=s.x-r,v=s.y-u,w=void 0;if(0!==g||0!==v)w=((n.x-r)*g+(n.y-u)*v)/(g*g+v*v),1<w?(r=s.x,u=s.y):0<w&&(r+=g*w,u+=v*w);n=(g=n.x-r,v=n.y-u,g*g+v*v);n>q&&(p=m,q=n)}q>e&&(c[p]=1,b.push(k),l.push(p),b.push(p),l.push(h));k=b.pop();h=l.pop()}for(m=0;m<d;m++)c[m]&&t.push(j[m]);return a=t,a};if("function"!==typeof y)var y=function(a){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),
d,c,j,k,h=0,m=0,n="",n=[];do d=a.charCodeAt(h++),c=a.charCodeAt(h++),j=a.charCodeAt(h++),k=d<<16|c<<8|j,d=k>>18&63,c=k>>12&63,j=k>>6&63,k&=63,n[m++]=e[d]+e[c]+e[j]+e[k];while(h<a.length);n=n.join("");a=a.length%3;return(a?n.slice(0,a-3):n)+"===".slice(a||3)};var p="image/svg+xml",h="image/svg+xml;base64";if("undefined"===typeof $)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");v=$.fn.jSignature;v("addPlugin","export","svg",w);v("addPlugin",
"export",p,w);v("addPlugin","export","svgbase64",A);v("addPlugin","export",h,A)})();